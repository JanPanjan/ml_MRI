Article: [Machine learning in Magnetic Resonance Imaging: Image reconstruction - ScienceDirect](https://www.sciencedirect.com/science/article/pii/S1120179721001095#s0060)

---

MRI signal is generated by the nuclei of hydrogen atoms as they interact with external electromagnetic fields. An MRI scanner cannot measure spatially dependent signals (images) directly. The spatial dependence is encoded into the frequency and phase of the MRI signal. This process is sequential, therefore long acquisition times.

Ultimately, a **spatial frequency map** is obtained, reffered to as [[k-space]]. In the simple case (an idealized scenario where the k-space data is [[fully and under-sampled data|fully sampled]] and noise free) the inverse Fourier Transform (iFT) can be used to reconstruct the k-space data into clinically interpretable images. 

> The simple case is hard to achieve because of the influence of various sources (thermal noise, system noise...).

Aquisition time of MRI scanning is roughly proportional to the number of k-space samples collected, so it's desired to collect as few samples as possible. If the sampling rate is reduced below that required by the Nyquist criterion, [[Aliasing artifacts]] will appear in the reconstructed image.

## The Forward Problem

k-space aquisition from an MR image can be described with the following equation:

$$
y = Ax + \epsilon
$$

This is called *the forward problem* and explains how the image ($x$) is transformed into the measured k-space data ($y$).

- $x$: the actual image you want to reconstruct. Think of it as a vector where each element corresponds to a pixel intensity.
- $A$: the system matrix. It represents the encoding process of the MRI scanner. It describes how the scanner aquires k-space data from the image. For example, in the simple case it would be related only to the Fourier transform.
- $y$: the measured k-space data. This is what the MRI scanner records.
- $\epsilon$: the noise term, random noise that inevitably contaminated the measurments.

> Take the image, apply the encoding, add some noise and you get the measured k-space data.

The goal of image reconstruction is to solve the *inverse* problem - given the measured k-space data ($y$), how do you find the original image ($x$)? We want to undo the encoding process.

## The inverse problem

The inverse problem is *ill-posed* when the k-space data is undersampled and noisy. An ill-posed problem has one or more characteristics:

- there might not be any image $x$ that perfectly explains the measured k-space.
- there might be infinitely many images $x$ that could have produced the measured k-space data.
- small changes in the measured k-space data $y$ due to noise can lead to large changes in the reconstructed image.

Because we are not measuring the all the k-space data by undersampling and our measurments are noisy, there is no single clear solution for the image. Trying to directly invert $A$ (like simply multiplying $A_{-1}$) won't work, because $A$ might not be invertible (especially if it's not a square matrix due to undersampling). Even if it is invertible, the noise will be amplified, leading to poor reconstruction.

## Least-Squares solution

Insted we try to find the "best solution". A common approach is to find the image $\hat{x}$ (our estimate of $x$) that minimizes the difference between the k-space data predicted by our image ($Ax$) and the actual measured k-space data ($y$). This is what is expressed with the equation:

$$
\hat{x} = \underset{x}{\text{argmin}} \frac{1}{2} \lVert Ax - y \rVert_{2}^2
$$

Taking the Euclidian distance of the difference between $Ax$ and $y$. This is what we want to minimize. The least-square formula is the basis for many image reconstruction algorithms.

---

In the general case, aliasing and signal degradation **cannot be avoided when sampling below the Nyquist rate**, as per the Nyquist-Shannon theorem. Reconstruction methods for accelerated MRI rely on some form of prior information or additional constraints on the reconstructed signal. However, the priors used in parallel imaging and compressed sensing are often crude, and **more representative priors** have the potential to improve current reconstruction techniques. However, designing such priors by hand is difficult. 

Artificial intelligence, on the other hand, excels at discovering patterns in data. Therefore, it is the ideal tool to inject the knowledge provided by historic MRI data into the image reconstruction.

## Deep learning

Deep neural networks are artificial neural networks with many layers (each layer recieves input, performs an operation on them and returns the output). Special NNs important in the MRI field are [[CNNs]].

In general, ML problems can be supervised or unsupervised. Supervised use known ground-truth data to learn a mapping between data pairs, whereas unsupervised infers structures within the sample without labeled outputs. Most applications in MRI use supervised learning techniques, unsupervised remain an area of active research.

## Supervised techniques

The algorithm learns a function that maps the input to an output from a training data set, consisting of paired input and output images. This requires **gold-standard fully sampled data** (the desired output), the ground truths in this case, paired with undersampled data (the input).

These aproaches require a qualitative metric or a **loss function**, which is used to evaluate how close the current output of the network is to the target image. Most commonly use are pixel-wise Mean Squarred Error and Mean Absolute Error, however these metrics do not reflect a radiologists' perspective well.

![[Pasted image 20250215225056.webp]]

## Unsupervised learning

The ML algorithm looks to find patterns in data without the need for any ground-truth data or user guidance. Unsupervised learning techniques provide a promising alternative in applications where ground-truth fully sampled datasets are unavailable and difficult (or impossible) to aquire, although it has been shown that state-of-the-art uns. learning techniques are currently unable to achieve as good image quality as supervised learning algorithms.

It has been used to train image restoration methods to remove noise from MRI images using only noisy training data.

GANs have been used to enforce data consistency in unsupervised learning. A conditional GAN is used to directly learn the mapping from k-space to image doman. The generator outputs an image from undersampled k-space data and the discriminator tries to differentiate between the original k-space and a randomly undersampled k-space created from the generated image.

## Available data

There is a relatively small number of publicly available data sets (and these are often very specific). These include raw k-space and DICOM imaging data sets.

- [mridata.org](http://mridata.org/)
- [fastMRI Dataset](https://fastmri.med.nyu.edu/) (check [[DATAAAAA]])
- [multi-field-strength brain MR dataset](https://www.sciencedirect.com/science/article/pii/S1053811917306687)